//スタート Start
//MQ（現状） MQCurrentStatus
//①利益 Profit
//②⑧MQ（未来） MQFuture
//③給料 Salary
//④経費 Expenses
//⑤製造原価(人) ManufacturingCostPerson
//⑥製造（経費) ManufacturingExpenses
//⑦原価詳細 CostDetail
//損益分岐点 BreakEvenPoint
//進捗実績値入力シート ProgressResultInput
//部門別販売計画 SalesPlanByDepartment
//利益計画表 ProfitPlaningTable

import { Data, DataType } from "@/models/data";

// Helper function to build sheet data
const buildSheetData = (
  sheetName: string,
  data: { [cell: string]: string | number }
): DataType[] => {
  return Object.entries(data).map(
    ([cell, val]): DataType => ({
      user: "",
      sheet: sheetName,
      cell,
      value: val,
    })
  );
};

// Sheet data definitions
const sheetsData: Record<string, { [cell: string]: string | number }> = {
  start: {
    C7: "=C6-G102",
    C8: '=IFERROR(C7/C6,"")',
    C102: "=SUM(G64:G67)",
    C103: "=SUM(G69:G72)",
    C104: "=G105+C102-C103",
    C105: "=SUM(G74:G77)",
    C106: "=SUM(G79:G82)",
    D57: "=SUM(D60:D62)",
    G102: "=SUM(D12:D58)+SUM(D63:D100)",
    G103: "=SUM(C12:C100)",
    G105: "=C7-G103",
    G106: "=C104+C105-C106",
  },
  mq_current_status: {
    B3: "=start!C6",
    B13: "=L3*Q3",
    F3: "=start!G102",
    F13: "=start!C7",
    H13: "=start!G103",
    H18: "=start!G105+start!C102-start!C103+start!C105-start!C106",
  },
  profit: {
    B6: "=B3+B4-B5",
    I5: "=B6+I3-I4",
    I7: "=I5/start!G106",
  },
  mq_future: {
    B3: "=manufacturing_income!F31/1000000",
    F3: "=manufacturing_expenses!I2",
    F13: "=ROUND(B3-F3, 1)",
    F17: "=manufacturing_income!B36/1000000-F13",
    G16: "=F13/B3",
    H13: "=expenses!I2*1000000/1000000",
    H18: "=F13-H13",
    I10: "=F3/B3",
    I16: "=H13/B3",
    I21: "=H18/B3",
    I22: "=profit!I5",
    L3: "=manufacturing_income!E31",
    L13: 0,
    Q3: "=manufacturing_income!D31",
    Q13: 0,
  },
  salary: {
    E6: "=C6*D6",
    E7: "=C7*D7",
    E8: "=C8*D8",
    E9: "=C9*D9",
    E10: "=C10*D10",
    E11: "=C11*D11",
    E12: "=C12*D12",
    E13: "=C13*D13",
    E14: "=SUM(E6:E13)",
    E15: "=start!C12",
    D14: "=SUM(D6:D13)",

    J6: "=H6*I6",
    J7: "=H7*I7",
    J8: "=H8*I8",
    J9: "=H9*I9",
    J10: "=H10*I10",
    J11: "=H11*I11",
    J12: "=H12*I12",
    J13: "=H13*I13",
    J14: "=SUM(J6:J13)",
    J15: "=start!C16",
    I14: "=SUM(I6:I13)",

    O6: "=M6*N6",
    O7: "=M7*N7",
    O8: "=M8*N8",
    O9: "=M9*N9",
    O10: "=M10*N10",
    O11: "=M11*N11",
    O12: "=M12*N12",
    O13: "=M13*N13",
    O14: "=SUM(O6:O13)",
    O15: "=start!C17+start!C18",
    N14: "=SUM(N6:N13)",

    C18: "=(E14+J14+O14)/(D14+I14+N14)",
    C19: '=IFERROR((E15+J15+O15)/(N15+I15+D15),"0")',

    E18: "=C18/C19",

    O1: "=E14+J14+O14",
  },
  expenses: {
    C43: "=SUM(C5:C42)",
    C44: "=SUM(start!C63:C100)",

    F13: "=SUM(F4:F12)",
    F14: "=SUM(start!C37:C42)",

    I5: "=salary!E14",
    I6: "=salary!J14",
    I7: "=salary!O14",
    I24: "=SUM(I5:I23)",
    I25: "=SUM(start!C12:C28)",
    L16: "=SUM(L5:L15)",
    L17: "=SUM(start!C29:C34)",

    I2: "=L16+I24+F13+C43",
  },
  manufacturing_labor: {
    E6: "=C6*D6",
    E7: "=C7*D7",
    E8: "=C8*D8",
    E9: "=C9*D9",
    E10: "=C10*D10",
    E11: "=C11*D11",
    E12: "=C12*D12",
    E13: "=C13*D13",
    E14: "=SUM(E6:E13)",
    E15: "=start!D60",
    D14: "=SUM(D6:D13)",

    J6: "=H6*I6",
    J7: "=H7*I7",
    J8: "=H8*I8",
    J9: "=H9*I9",
    J10: "=H10*I10",
    J11: "=H11*I11",
    J12: "=H12*I12",
    J13: "=H13*I13",
    J14: "=SUM(J6:J13)",
    J15: "=start!D61",
    I14: "=SUM(I6:I13)",

    O6: "=M6*N6",
    O7: "=M7*N7",
    O8: "=M8*N8",
    O9: "=M9*N9",
    O10: "=M10*N10",
    O11: "=M11*N11",
    O12: "=M12*N12",
    O13: "=M13*N13",
    O14: "=SUM(O6:O13)",
    O15: "=start!D62",
    N14: "=SUM(N6:N13)",

    C18: "=(E14+J14+O14)/(D14+I14+N14)",
    C19: '=IFERROR((E15+J15+O15)/(N15+I15+D15),"0")',

    E18: "=C18/C19",

    O1: "=E14+J14+O14",
  },
  manufacturing_expenses: {
    C43: "=SUM(C5:C42)",
    C44: "=SUM(start!D63:D100)",

    F13: "=SUM(F4:F12)",
    F14: "=SUM(start!D35:D42)",

    I5: "=start!D60",
    I6: "=start!D61",
    I7: "=start!D62",
    I16: "=SUM(I5:I15)",
    I17: "=SUM(start!D13:D28)+SUM(start!D60:D62)",

    L20: "=SUM(L5:L19)",
    L21: "=SUM(start!D43:D56)",

    I2: "=L20+I16+F13+C43",
  },
  manufacturing_income: {
    G2: "=F31",

    B8: "=D8*C8",
    B9: "=D9*C9",
    B10: "=D10*C10",
    B11: "=D11*C11",
    B12: "=D12*C12",
    B13: "=D13*C13",
    B14: "=D14*C14",
    B15: "=D15*C15",
    B16: "=D16*C16",
    B17: "=D17*C17",
    B18: "=D18*C18",
    B19: "=D19*C19",
    B20: "=D20*C20",
    B21: "=D21*C21",
    B22: "=D22*C22",
    B23: "=D23*C23",
    B24: "=D24*C24",
    B25: "=D25*C25",
    B26: "=D26*C26",
    B27: "=D27*C27",
    B28: "=D28*C28",
    B29: "=D29*C29",

    F8: "=D8*E8",
    F9: "=D9*E9",
    F10: "=D10*E10",
    F11: "=D11*E11",
    F12: "=D12*E12",
    F13: "=D13*E13",
    F14: "=D14*E14",
    F15: "=D15*E15",
    F16: "=D16*E16",
    F17: "=D17*E17",
    F18: "=D18*E18",
    F19: "=D19*E19",
    F20: "=D20*E20",
    F21: "=D21*E21",
    F22: "=D22*E22",
    F23: "=D23*E23",
    F24: "=D24*E24",
    F25: "=D25*E25",
    F26: "=D26*E26",
    F27: "=D27*E27",
    F28: "=D28*E28",
    F29: "=D29*E29",

    G8: '=IFERROR(C8/E8,"0")',
    G9: '=IFERROR(C9/E9,"0")',
    G10: '=IFERROR(C10/E10,"0")',
    G11: '=IFERROR(C11/E11,"0")',
    G12: '=IFERROR(C12/E12,"0")',
    G13: '=IFERROR(C13/E13,"0")',
    G14: '=IFERROR(C14/E14,"0")',
    G15: '=IFERROR(C15/E15,"0")',
    G16: '=IFERROR(C16/E16,"0")',
    G17: '=IFERROR(C17/E17,"0")',
    G18: '=IFERROR(C18/E18,"0")',
    G19: '=IFERROR(C19/E19,"0")',
    G20: '=IFERROR(C20/E20,"0")',
    G21: '=IFERROR(C21/E21,"0")',
    G22: '=IFERROR(C22/E22,"0")',
    G23: '=IFERROR(C23/E23,"0")',
    G24: '=IFERROR(C24/E24,"0")',
    G25: '=IFERROR(C25/E25,"0")',
    G26: '=IFERROR(C26/E26,"0")',
    G27: '=IFERROR(C27/E27,"0")',
    G28: '=IFERROR(C28/E28,"0")',
    G29: '=IFERROR(C29/E29,"0")',

    B31: "=SUM(B8:B29)",
    C31: '=AVERAGE(C8:C29,"0")',
    D31: "=SUM(D8:D29)",
    E31: '=IFERROR(F31/D31,"")',
    F31: "=SUM(F8:F29)",
    G31: '=IFERROR(AVERAGE(G8:G29),"")',

    G33: "=salary!D14+salary!I14+salary!N14+manufacturing_labor!D14+manufacturing_labor!I14+manufacturing_labor!N14",

    B34: "=ROUND(mq_future!F17*1000, 0)",
    C34: '=IFERROR(B31/F31,"")',

    B36: "=B31",
    F36: "=B36/G33",
    G36: "=F31/G33",
  },
  break_even_point: {
    B2: "=manufacturing_income!F31",
    B3: "=manufacturing_expenses!I2*1000000",
    B4: "=expenses!I2*1000000",
    B5: "=B3/B2",
    B6: "=B4/(1-B3/B2)",

    E2: "=start!C6*1000000",
    E3: "=start!G102*1000000",
    E4: "=start!G103*1000000",
    E5: "=E3/E2",
    E6: "=E4/(1-E3/E2)",
  },
  progress_result_input: {
    B2: "=start!G1",
    L2: "=C6/C5",

    C3: "=mq_future!B3*1000",

    C5: "=mq_current_status!B3",
    C6: "=mq_future!B3",
    C7: "=mq_future!F13",
    C8: '=IFERROR(mq_future!G16,"")',
    C9: "=L21+L35+L46+Q44",
    C10: "=C11+C12",
    C11: "=C61+G39+G17",
    C12: "=G50",
    C13: "=C6-C9-C10",
    C14: "=profit!B4",
    C15: "=profit!B5",
    C16: "=C13+C14-C15",
    C17: "=profit!I3",
    C18: "=profit!I4",
    C19: "=C16+C17-C18",
    C20: "=C19",
    D20: "=D19",

    C22: "=expenses!C5",
    C23: "=expenses!C6",
    C24: "=expenses!C7",
    C25: "=expenses!C8",
    C26: "=expenses!C9",
    C27: "=expenses!C10",
    C28: "=expenses!C11",
    C29: "=expenses!C12",
    C30: "=expenses!C13",
    C31: "=expenses!C14",
    C32: "=expenses!C15",
    C33: "=expenses!C16",
    C34: "=expenses!C17",
    C35: "=expenses!C18",
    C36: "=expenses!C19",
    C37: "=expenses!C20",
    C38: "=expenses!C21",
    C39: "=expenses!C22",
    C40: "=expenses!C23",
    C41: "=expenses!C24",
    C42: "=expenses!C25",
    C43: "=expenses!C26",
    C44: "=expenses!C27",
    C45: "=expenses!C28",
    C46: "=expenses!C29",
    C47: "=expenses!C30",
    C48: "=expenses!C31",
    C49: "=expenses!C32",
    C50: "=expenses!C33",
    C51: "=expenses!C34",
    C52: "=expenses!C35",
    C53: "=expenses!C36",
    C54: "=expenses!C37",
    C55: "=expenses!C38",
    C56: "=expenses!C39",
    C57: "=expenses!C40",
    C58: "=expenses!C40",
    C59: "=expenses!C41",
    C60: "=expenses!C42",
    C61: "=SUM(C23:C60)",
    D61: "=SUM(D23:D60)",

    G6: "=expenses!L5",
    G7: "=expenses!L6",
    G8: "=expenses!L7",
    G9: "=expenses!L8",
    G10: "=expenses!L9",
    G11: "=expenses!L10",
    G12: "=expenses!L11",
    G13: "=expenses!L12",
    G14: "=expenses!L13",
    G15: "=expenses!L14",
    G16: "=expenses!L15",
    G17: "=SUM(G6:G16)",
    H17: "=SUM(H6:H16)",

    G20: "=expenses!I5",
    G21: "=expenses!I6",
    G22: "=expenses!I7",
    G23: "=expenses!I8",
    G24: "=expenses!I9",
    G25: "=expenses!I10",
    G26: "=expenses!I11",
    G27: "=expenses!I12",
    G28: "=expenses!I13",
    G29: "=expenses!I14",
    G30: "=expenses!I15",
    G31: "=expenses!I16",
    G32: "=expenses!I17",
    G33: "=expenses!I18",
    G34: "=expenses!I19",
    G35: "=expenses!I20",
    G36: "=expenses!I21",
    G37: "=expenses!I22",
    G38: "=expenses!I23",
    G39: "=SUM(G20:G38)",
    H39: "=SUM(H20:H38)",

    G41: "=expenses!F12",
    G42: "=expenses!F13",
    G43: "=expenses!F14",
    G44: "=expenses!F15",
    G45: "=expenses!F16",
    G46: "=expenses!F17",
    G47: "=expenses!F18",
    G48: "=expenses!F19",
    G49: "=expenses!F20",
    G50: "=SUM(G41:G49)",
    H50: "=SUM(H41:H49)",

    L6: "=manufacturing_expenses!L5",
    L7: "=manufacturing_expenses!L6",
    L8: "=manufacturing_expenses!L7",
    L9: "=manufacturing_expenses!L8",
    L10: "=manufacturing_expenses!L9",
    L11: "=manufacturing_expenses!L10",
    L12: "=manufacturing_expenses!L11",
    L13: "=manufacturing_expenses!L12",
    L14: "=manufacturing_expenses!L13",
    L15: "=manufacturing_expenses!L14",
    L16: "=manufacturing_expenses!L15",
    L17: "=manufacturing_expenses!L16",
    L18: "=manufacturing_expenses!L17",
    L19: "=manufacturing_expenses!L18",
    L20: "=manufacturing_expenses!L19",
    L21: "=SUM(L6:L20)",
    M21: "=SUM(M6:M20)",

    L24: "=manufacturing_expenses!I5",
    L25: "=manufacturing_expenses!I6",
    L26: "=manufacturing_expenses!I7",
    L27: "=manufacturing_expenses!I8",
    L28: "=manufacturing_expenses!I9",
    L29: "=manufacturing_expenses!I10",
    L30: "=manufacturing_expenses!I11",
    L31: "=manufacturing_expenses!I12",
    L32: "=manufacturing_expenses!I13",
    L33: "=manufacturing_expenses!I14",
    L34: "=manufacturing_expenses!I15",
    L35: "=SUM(L24:L34)",
    M35: "=SUM(M24:M34)",

    L37: "=manufacturing_expenses!F4",
    L38: "=manufacturing_expenses!F5",
    L39: "=manufacturing_expenses!F6",
    L40: "=manufacturing_expenses!F7",
    L41: "=manufacturing_expenses!F8",
    L42: "=manufacturing_expenses!F9",
    L43: "=manufacturing_expenses!F10",
    L44: "=manufacturing_expenses!F11",
    L45: "=manufacturing_expenses!F12",
    L46: "=SUM(L37:L45)",
    M46: "=SUM(M37:M45)",

    Q6: "=manufacturing_expenses!C5",
    Q7: "=manufacturing_expenses!C6",
    Q8: "=manufacturing_expenses!C7",
    Q9: "=manufacturing_expenses!C8",
    Q10: "=manufacturing_expenses!C9",
    Q11: "=manufacturing_expenses!C10",
    Q12: "=manufacturing_expenses!C11",
    Q13: "=manufacturing_expenses!C12",
    Q14: "=manufacturing_expenses!C13",
    Q15: "=manufacturing_expenses!C14",
    Q16: "=manufacturing_expenses!C15",
    Q17: "=manufacturing_expenses!C16",
    Q18: "=manufacturing_expenses!C17",
    Q19: "=manufacturing_expenses!C18",
    Q20: "=manufacturing_expenses!C19",
    Q21: "=manufacturing_expenses!C20",
    Q22: "=manufacturing_expenses!C21",
    Q23: "=manufacturing_expenses!C22",
    Q24: "=manufacturing_expenses!C23",
    Q25: "=manufacturing_expenses!C24",
    Q26: "=manufacturing_expenses!C25",
    Q27: "=manufacturing_expenses!C26",
    Q28: "=manufacturing_expenses!C27",
    Q29: "=manufacturing_expenses!C28",
    Q30: "=manufacturing_expenses!C29",
    Q31: "=manufacturing_expenses!C30",
    Q32: "=manufacturing_expenses!C31",
    Q33: "=manufacturing_expenses!C32",
    Q34: "=manufacturing_expenses!C33",
    Q35: "=manufacturing_expenses!C34",
    Q36: "=manufacturing_expenses!C35",
    Q37: "=manufacturing_expenses!C36",
    Q38: "=manufacturing_expenses!C37",
    Q39: "=manufacturing_expenses!C38",
    Q40: "=manufacturing_expenses!C39",
    Q41: "=manufacturing_expenses!C40",
    Q42: "=manufacturing_expenses!C41",
    Q43: "=manufacturing_expenses!C42",
    Q44: "=SUM(Q6:Q43)",
    R44: "=SUM(R6:R43)",
  },
  sales_plan_by_department: {
    A3:"=manufacturing_income!A8",
    A5:"=manufacturing_income!A9",
    A7:"=manufacturing_income!A10",
    A9:"=manufacturing_income!A11",
    A11:"=manufacturing_income!A12",
    A13:"=manufacturing_income!A13",
    A15:"=manufacturing_income!A14",
    A17:"=manufacturing_income!A15",
    A19:"=manufacturing_income!A16",
    A21:"=manufacturing_income!A17",
    A23:"=manufacturing_income!A18",
    A25:"=manufacturing_income!A19",
    A27:"=manufacturing_income!A20",
    A29:"=manufacturing_income!A21",
    A31:"=manufacturing_income!A22",
    A33:"=manufacturing_income!A23",
    A35:"=manufacturing_income!A24",
    A37:"=manufacturing_income!A25",
    A39:"=manufacturing_income!A26",
    A41:"=manufacturing_income!A27",
    A43:"=manufacturing_income!A28",
    A45:"=manufacturing_income!A29",

    B2: "=manufacturing_income!G2",
    B3: "=manufacturing_income!F8/1000000",
    B4: "=B3-D3-F3-H3-J3-L3-N3-P3-R3-T3-V3-X3-Z3",
    B5: "=manufacturing_income!F9/1000000",
    B6: "=B5-D5-F5-H5-J5-L5-N5-P5-R5-T5-V5-X5-Z5",
    B7: "=manufacturing_income!F10/1000000",
    B8: "=B7-D7-F7-H7-J7-L7-N7-P7-R7-T7-V7-X7-Z7",
    B9: "=manufacturing_income!F11/1000000",
    B10: "=B9-D9-F9-H9-J9-L9-N9-P9-R9-T9-V9-X9-Z9",
    B11: "=manufacturing_income!F12/1000000",
    B12: "=B11-D11-F11-H11-J11-L11-N11-P11-R11-T11-V11-X11-Z11",
    B13: "=manufacturing_income!F13/1000000",
    B14: "=B13-D13-F13-H13-J13-L13-N13-P13-R13-T13-V13-X13-Z13",
    B15: "=manufacturing_income!F14/1000000",
    B16: "=B15-D15-F15-H15-J15-L15-N15-P15-R15-T15-V15-X15-Z15",
    B17: "=manufacturing_income!F15/1000000",
    B18: "=B17-D17-F17-H17-J17-L17-N17-P17-R17-T17-V17-X17-Z17",
    B19: "=manufacturing_income!F16/1000000",
    B20: "=B19-D19-F19-H19-J19-L19-N19-P19-R19-T19-V19-X19-Z19",
    B21: "=manufacturing_income!F17/1000000",
    B22: "=B21-D21-F21-H21-J21-L21-N21-P21-R21-T21-V21-X21-Z21",
    B23: "=manufacturing_income!F18/1000000",
    B24: "=B23-D23-F23-H23-J23-L23-N23-P23-R23-T23-V23-X23-Z23",
    B25: "=manufacturing_income!F19/1000000",
    B26: "=B25-D25-F25-H25-J25-L25-N25-P25-R25-T25-V25-X25-Z25",
    B27: "=manufacturing_income!F20/1000000",
    B28: "=B27-D27-F27-H27-J27-L27-N27-P27-R27-T27-V27-X27-Z27",
    B29: "=manufacturing_income!F21/1000000",
    B30: "=B29-D29-F29-H29-J29-L29-N29-P29-R29-T29-V29-X29-Z29",
    B31: "=manufacturing_income!F22/1000000",
    B32: "=B31-D31-F31-H31-J31-L31-N31-P31-R31-T31-V31-X31-Z31",
    B33: "=manufacturing_income!F23/1000000",
    B34: "=B33-D33-F33-H33-J33-L33-N33-P33-R33-T33-V33-X33-Z33",
    B35: "=manufacturing_income!F24/1000000",
    B36: "=B35-D35-F35-H35-J35-L35-N35-P35-R35-T35-V35-X35-Z35",
    B37: "=manufacturing_income!F25/1000000",
    B38: "=B37-D37-F37-H37-J37-L37-N37-P37-R37-T37-V37-X37-Z37",
    B39: "=manufacturing_income!F26/1000000",
    B40: "=B39-D39-F39-H39-J39-L39-N39-P39-R39-T39-V39-X39-Z39",
    B41: "=manufacturing_income!F27/1000000",
    B42: "=B41-D41-F41-H41-J41-L41-N41-P41-R41-T41-V41-X41-Z41",
    B43: "=manufacturing_income!F28/1000000",
    B44: "=B43-D43-F43-H43-J43-L43-N43-P43-R43-T43-V43-X43-Z43",
    B45: "=manufacturing_income!F29/1000000",
    B46: "=B45-D45-F45-H45-J45-L45-N45-P45-R45-T45-V45-X45-Z45",

    E3: "=D3",
    E4: "=D4",
    E5: "=D5",
    E6: "=D6",
    E7: "=D7",
    E8: "=D8",
    E9: "=D9",
    E10: "=D10",
    E11: "=D11",
    E12: "=D12",
    E13: "=D13",
    E14: "=D14",
    E15: "=D15",
    E16: "=D16",
    E17: "=D17",
    E18: "=D18",
    E19: "=D19",
    E20: "=D20",
    E21: "=D21",
    E22: "=D22",
    E23: "=D23",
    E24: "=D24",
    E25: "=D25",
    E26: "=D26",
    E27: "=D27",
    E28: "=D28",
    E29: "=D29",
    E30: "=D30",
    E31: "=D31",
    E32: "=D32",
    E33: "=D33",
    E34: "=D34",
    E35: "=D35",
    E36: "=D36",
    E37: "=D37",
    E38: "=D38",
    E39: "=D39",
    E40: "=D40",
    E41: "=D41",
    E42: "=D42",
    E43: "=D43",
    E44: "=D44",
    E45: "=D45",
    E46: "=D46",

    G3: "=E3+F3",
    G4: "=E4+F4",
    G5: "=E5+F5",
    G6: "=E6+F6",
    G7: "=E7+F7",
    G8: "=E8+F8",
    G9: "=E9+F9",
    G10: "=E10+F10",
    G11: "=E11+F11",
    G12: "=E12+F12",
    G13: "=E13+F13",
    G14: "=E14+F14",
    G15: "=E15+F15",
    G16: "=E16+F16",
    G17: "=E17+F17",
    G18: "=E18+F18",
    G19: "=E19+F19",
    G20: "=E20+F20",
    G21: "=E21+F21",
    G22: "=E22+F22",
    G23: "=E23+F23",
    G24: "=E24+F24",
    G25: "=E25+F25",
    G26: "=E26+F26",
    G27: "=E27+F27",
    G28: "=E28+F28",
    G29: "=E29+F29",
    G30: "=E30+F30",
    G31: "=E31+F31",
    G32: "=E32+F32",
    G33: "=E33+F33",
    G34: "=E34+F34",
    G35: "=E35+F35",
    G36: "=E36+F36",
    G37: "=E37+F37",
    G38: "=E38+F38",
    G39: "=E39+F39",
    G40: "=E40+F40",
    G41: "=E41+F41",
    G42: "=E42+F42",
    G43: "=E43+F43",
    G44: "=E44+F44",
    G45: "=E45+F45",
    G46: "=E46+F46",

    I3: "=G3+H3",
    I4: "=G4+H4",
    I5: "=G5+H5",
    I6: "=G6+H6",
    I7: "=G7+H7",
    I8: "=G8+H8",
    I9: "=G9+H9",
    I10: "=G10+H10",
    I11: "=G11+H11",
    I12: "=G12+H12",
    I13: "=G13+H13",
    I14: "=G14+H14",
    I15: "=G15+H15",
    I16: "=G16+H16",
    I17: "=G17+H17",
    I18: "=G18+H18",
    I19: "=G19+H19",
    I20: "=G20+H20",
    I21: "=G21+H21",
    I22: "=G22+H22",
    I23: "=G23+H23",
    I24: "=G24+H24",
    I25: "=G25+H25",
    I26: "=G26+H26",
    I27: "=G27+H27",
    I28: "=G28+H28",
    I29: "=G29+H29",
    I30: "=G30+H30",
    I31: "=G31+H31",
    I32: "=G32+H32",
    I33: "=G33+H33",
    I34: "=G34+H34",
    I35: "=G35+H35",
    I36: "=G36+H36",
    I37: "=G37+H37",
    I38: "=G38+H38",
    I39: "=G39+H39",
    I40: "=G40+H40",
    I41: "=G41+H41",
    I42: "=G42+H42",
    I43: "=G43+H43",
    I44: "=G44+H44",
    I45: "=G45+H45",
    I46: "=G46+H46",

    K3: "=I3+J3",
    K4: "=I4+J4",
    K5: "=I5+J5",
    K6: "=I6+J6",
    K7: "=I7+J7",
    K8: "=I8+J8",
    K9: "=I9+J9",
    K10: "=I10+J10",
    K11: "=I11+J11",
    K12: "=I12+J12",
    K13: "=I13+J13",
    K14: "=I14+J14",
    K15: "=I15+J15",
    K16: "=I16+J16",
    K17: "=I17+J17",
    K18: "=I18+J18",
    K19: "=I19+J19",
    K20: "=I20+J20",
    K21: "=I21+J21",
    K22: "=I22+J22",
    K23: "=I23+J23",
    K24: "=I24+J24",
    K25: "=I25+J25",
    K26: "=I26+J26",
    K27: "=I27+J27",
    K28: "=I28+J28",
    K29: "=I29+J29",
    K30: "=I30+J30",
    K31: "=I31+J31",
    K32: "=I32+J32",
    K33: "=I33+J33",
    K34: "=I34+J34",
    K35: "=I35+J35",
    K36: "=I36+J36",
    K37: "=I37+J37",
    K38: "=I38+J38",
    K39: "=I39+J39",
    K40: "=I40+J40",
    K41: "=I41+J41",
    K42: "=I42+J42",
    K43: "=I43+J43",
    K44: "=I44+J44",
    K45: "=I45+J45",
    K46: "=I46+J46",

    M3: "=K3+L3",
    M4: "=K4+L4",
    M5: "=K5+L5",
    M6: "=K6+L6",
    M7: "=K7+L7",
    M8: "=K8+L8",
    M9: "=K9+L9",
    M10: "=K10+L10",
    M11: "=K11+L11",
    M12: "=K12+L12",
    M13: "=K13+L13",
    M14: "=K14+L14",
    M15: "=K15+L15",
    M16: "=K16+L16",
    M17: "=K17+L17",
    M18: "=K18+L18",
    M19: "=K19+L19",
    M20: "=K20+L20",
    M21: "=K21+L21",
    M22: "=K22+L22",
    M23: "=K23+L23",
    M24: "=K24+L24",
    M25: "=K25+L25",
    M26: "=K26+L26",
    M27: "=K27+L27",
    M28: "=K28+L28",
    M29: "=K29+L29",
    M30: "=K30+L30",
    M31: "=K31+L31",
    M32: "=K32+L32",
    M33: "=K33+L33",
    M34: "=K34+L34",
    M35: "=K35+L35",
    M36: "=K36+L36",
    M37: "=K37+L37",
    M38: "=K38+L38",
    M39: "=K39+L39",
    M40: "=K40+L40",
    M41: "=K41+L41",
    M42: "=K42+L42",
    M43: "=K43+L43",
    M44: "=K44+L44",
    M45: "=K45+L45",
    M46: "=K46+L46",

    O3: "=M3+N3",
    O4: "=M4+N4",
    O5: "=M5+N5",
    O6: "=M6+N6",
    O7: "=M7+N7",
    O8: "=M8+N8",
    O9: "=M9+N9",
    O10: "=M10+N10",
    O11: "=M11+N11",
    O12: "=M12+N12",
    O13: "=M13+N13",
    O14: "=M14+N14",
    O15: "=M15+N15",
    O16: "=M16+N16",
    O17: "=M17+N17",
    O18: "=M18+N18",
    O19: "=M19+N19",
    O20: "=M20+N20",
    O21: "=M21+N21",
    O22: "=M22+N22",
    O23: "=M23+N23",
    O24: "=M24+N24",
    O25: "=M25+N25",
    O26: "=M26+N26",
    O27: "=M27+N27",
    O28: "=M28+N28",
    O29: "=M29+N29",
    O30: "=M30+N30",
    O31: "=M31+N31",
    O32: "=M32+N32",
    O33: "=M33+N33",
    O34: "=M34+N34",
    O35: "=M35+N35",
    O36: "=M36+N36",
    O37: "=M37+N37",
    O38: "=M38+N38",
    O39: "=M39+N39",
    O40: "=M40+N40",
    O41: "=M41+N41",
    O42: "=M42+N42",
    O43: "=M43+N43",
    O44: "=M44+N44",
    O45: "=M45+N45",
    O46: "=M46+N46",

    Q3: "=O3+P3",
    Q4: "=O4+P4",
    Q5: "=O5+P5",
    Q6: "=O6+P6",
    Q7: "=O7+P7",
    Q8: "=O8+P8",
    Q9: "=O9+P9",
    Q10: "=O10+P10",
    Q11: "=O11+P11",
    Q12: "=O12+P12",
    Q13: "=O13+P13",
    Q14: "=O14+P14",
    Q15: "=O15+P15",
    Q16: "=O16+P16",
    Q17: "=O17+P17",
    Q18: "=O18+P18",
    Q19: "=O19+P19",
    Q20: "=O20+P20",
    Q21: "=O21+P21",
    Q22: "=O22+P22",
    Q23: "=O23+P23",
    Q24: "=O24+P24",
    Q25: "=O25+P25",
    Q26: "=O26+P26",
    Q27: "=O27+P27",
    Q28: "=O28+P28",
    Q29: "=O29+P29",
    Q30: "=O30+P30",
    Q31: "=O31+P31",
    Q32: "=O32+P32",
    Q33: "=O33+P33",
    Q34: "=O34+P34",
    Q35: "=O35+P35",
    Q36: "=O36+P36",
    Q37: "=O37+P37",
    Q38: "=O38+P38",
    Q39: "=O39+P39",
    Q40: "=O40+P40",
    Q41: "=O41+P41",
    Q42: "=O42+P42",
    Q43: "=O43+P43",
    Q44: "=O44+P44",
    Q45: "=O45+P45",
    Q46: "=O46+P46",

    S3: "=Q3+R3",
    S4: "=Q4+R4",
    S5: "=Q5+R5",
    S6: "=Q6+R6",
    S7: "=Q7+R7",
    S8: "=Q8+R8",
    S9: "=Q9+R9",
    S10: "=Q10+R10",
    S11: "=Q11+R11",
    S12: "=Q12+R12",
    S13: "=Q13+R13",
    S14: "=Q14+R14",
    S15: "=Q15+R15",
    S16: "=Q16+R16",
    S17: "=Q17+R17",
    S18: "=Q18+R18",
    S19: "=Q19+R19",
    S20: "=Q20+R20",
    S21: "=Q21+R21",
    S22: "=Q22+R22",
    S23: "=Q23+R23",
    S24: "=Q24+R24",
    S25: "=Q25+R25",
    S26: "=Q26+R26",
    S27: "=Q27+R27",
    S28: "=Q28+R28",
    S29: "=Q29+R29",
    S30: "=Q30+R30",
    S31: "=Q31+R31",
    S32: "=Q32+R32",
    S33: "=Q33+R33",
    S34: "=Q34+R34",
    S35: "=Q35+R35",
    S36: "=Q36+R36",
    S37: "=Q37+R37",
    S38: "=Q38+R38",
    S39: "=Q39+R39",
    S40: "=Q40+R40",
    S41: "=Q41+R41",
    S42: "=Q42+R42",
    S43: "=Q43+R43",
    S44: "=Q44+R44",
    S45: "=Q45+R45",
    S46: "=Q46+R46",

    U3: "=S3+T3",
    U4: "=S4+T4",
    U5: "=S5+T5",
    U6: "=S6+T6",
    U7: "=S7+T7",
    U8: "=S8+T8",
    U9: "=S9+T9",
    U10: "=S10+T10",
    U11: "=S11+T11",
    U12: "=S12+T12",
    U13: "=S13+T13",
    U14: "=S14+T14",
    U15: "=S15+T15",
    U16: "=S16+T16",
    U17: "=S17+T17",
    U18: "=S18+T18",
    U19: "=S19+T19",
    U20: "=S20+T20",
    U21: "=S21+T21",
    U22: "=S22+T22",
    U23: "=S23+T23",
    U24: "=S24+T24",
    U25: "=S25+T25",
    U26: "=S26+T26",
    U27: "=S27+T27",
    U28: "=S28+T28",
    U29: "=S29+T29",
    U30: "=S30+T30",
    U31: "=S31+T31",
    U32: "=S32+T32",
    U33: "=S33+T33",
    U34: "=S34+T34",
    U35: "=S35+T35",
    U36: "=S36+T36",
    U37: "=S37+T37",
    U38: "=S38+T38",
    U39: "=S39+T39",
    U40: "=S40+T40",
    U41: "=S41+T41",
    U42: "=S42+T42",
    U43: "=S43+T43",
    U44: "=S44+T44",
    U45: "=S45+T45",
    U46: "=S46+T46",

    W3: "=U3+V3",
    W4: "=U4+V4",
    W5: "=U5+V5",
    W6: "=U6+V6",
    W7: "=U7+V7",
    W8: "=U8+V8",
    W9: "=U9+V9",
    W10: "=U10+V10",
    W11: "=U11+V11",
    W12: "=U12+V12",
    W13: "=U13+V13",
    W14: "=U14+V14",
    W15: "=U15+V15",
    W16: "=U16+V16",
    W17: "=U17+V17",
    W18: "=U18+V18",
    W19: "=U19+V19",
    W20: "=U20+V20",
    W21: "=U21+V21",
    W22: "=U22+V22",
    W23: "=U23+V23",
    W24: "=U24+V24",
    W25: "=U25+V25",
    W26: "=U26+V26",
    W27: "=U27+V27",
    W28: "=U28+V28",
    W29: "=U29+V29",
    W30: "=U30+V30",
    W31: "=U31+V31",
    W32: "=U32+V32",
    W33: "=U33+V33",
    W34: "=U34+V34",
    W35: "=U35+V35",
    W36: "=U36+V36",
    W37: "=U37+V37",
    W38: "=U38+V38",
    W39: "=U39+V39",
    W40: "=U40+V40",
    W41: "=U41+V41",
    W42: "=U42+V42",
    W43: "=U43+V43",
    W44: "=U44+V44",
    W45: "=U45+V45",
    W46: "=U46+V46",

    Y3: "=W3+X3",
    Y4: "=W4+X4",
    Y5: "=W5+X5",
    Y6: "=W6+X6",
    Y7: "=W7+X7",
    Y8: "=W8+X8",
    Y9: "=W9+X9",
    Y10: "=W10+X10",
    Y11: "=W11+X11",
    Y12: "=W12+X12",
    Y13: "=W13+X13",
    Y14: "=W14+X14",
    Y15: "=W15+X15",
    Y16: "=W16+X16",
    Y17: "=W17+X17",
    Y18: "=W18+X18",
    Y19: "=W19+X19",
    Y20: "=W20+X20",
    Y21: "=W21+X21",
    Y22: "=W22+X22",
    Y23: "=W23+X23",
    Y24: "=W24+X24",
    Y25: "=W25+X25",
    Y26: "=W26+X26",
    Y27: "=W27+X27",
    Y28: "=W28+X28",
    Y29: "=W29+X29",
    Y30: "=W30+X30",
    Y31: "=W31+X31",
    Y32: "=W32+X32",
    Y33: "=W33+X33",
    Y34: "=W34+X34",
    Y35: "=W35+X35",
    Y36: "=W36+X36",
    Y37: "=W37+X37",
    Y38: "=W38+X38",
    Y39: "=W39+X39",
    Y40: "=W40+X40",
    Y41: "=W41+X41",
    Y42: "=W42+X42",
    Y43: "=W43+X43",
    Y44: "=W44+X44",
    Y45: "=W45+X45",
    Y46: "=W46+X46",

    AA3: "=Y3+Z3",
    AA4: "=Y4+Z4",
    AA5: "=Y5+Z5",
    AA6: "=Y6+Z6",
    AA7: "=Y7+Z7",
    AA8: "=Y8+Z8",
    AA9: "=Y9+Z9",
    AA10: "=Y10+Z10",
    AA11: "=Y11+Z11",
    AA12: "=Y12+Z12",
    AA13: "=Y13+Z13",
    AA14: "=Y14+Z14",
    AA15: "=Y15+Z15",
    AA16: "=Y16+Z16",
    AA17: "=Y17+Z17",
    AA18: "=Y18+Z18",
    AA19: "=Y19+Z19",
    AA20: "=Y20+Z20",
    AA21: "=Y21+Z21",
    AA22: "=Y22+Z22",
    AA23: "=Y23+Z23",
    AA24: "=Y24+Z24",
    AA25: "=Y25+Z25",
    AA26: "=Y26+Z26",
    AA27: "=Y27+Z27",
    AA28: "=Y28+Z28",
    AA29: "=Y29+Z29",
    AA30: "=Y30+Z30",
    AA31: "=Y31+Z31",
    AA32: "=Y32+Z32",
    AA33: "=Y33+Z33",
    AA34: "=Y34+Z34",
    AA35: "=Y35+Z35",
    AA36: "=Y36+Z36",
    AA37: "=Y37+Z37",
    AA38: "=Y38+Z38",
    AA39: "=Y39+Z39",
    AA40: "=Y40+Z40",
    AA41: "=Y41+Z41",
    AA42: "=Y42+Z42",
    AA43: "=Y43+Z43",
    AA44: "=Y44+Z44",
    AA45: "=Y45+Z45",
    AA46: "=Y46+Z46",
  },
  profit_planing_table: {
    B3: "=B6/B4",
    C3: "=B3+0.01",
    D3: "=B3+0.02",
    E3: "=B3+0.03",
    F3: "=B3+0.04",
    G3: "=B3+0.05",
    H3: "=B3+0.06",
    I3: "=B3+0.07",
    J3: "=B3+0.08",
    K3: "=B3+0.09",
    L3: "=B3+0.10",

    B4: "=manufacturing_income!F31",
    C4: "=$B$4",
    D4: "=$B$4",
    E4: "=$B$4",
    F4: "=$B$4",
    G4: "=$B$4",
    H4: "=$B$4",
    I4: "=$B$4",
    J4: "=$B$4",
    K4: "=$B$4",
    L4: "=$B$4",

    B5: "=mq_future!F3*1000000",
    C5: "=C4-C6",
    D5: "=D4-D6",
    E5: "=E4-E6",
    F5: "=F4-F6",
    G5: "=G4-G6",
    H5: "=H4-H6",
    I5: "=I4-I6",
    J5: "=J4-J6",
    K5: "=K4-K6",
    L5: "=L4-L6",

    B6: "=B4-B5",
    C6: "=$B$4*C3",
    D6: "=$B$4*D3",
    E6: "=$B$4*E3",
    F6: "=$B$4*F3",
    G6: "=$B$4*G3",
    H6: "=$B$4*H3",
    I6: "=$B$4*I3",
    J6: "=$B$4*J3",
    K6: "=$B$4*K3",
    L6: "=$B$4*L3",

    B7: "=mq_future!H13*1000000",
    C7: "=B7",
    D7: "=B7",
    E7: "=B7",
    F7: "=B7",
    G7: "=B7",
    H7: "=B7",
    I7: "=B7",
    J7: "=B7",
    K7: "=B7",
    L7: "=B7",

    B8: "=B4-B5-B7",
    C8: "=C4-C5-C7",
    D8: "=D4-D5-D7",
    E8: "=E4-E5-E7",
    F8: "=F4-F5-F7",
    G8: "=G4-G5-G7",
    H8: "=H4-H5-H7",
    I8: "=I4-I5-I7",
    J8: "=J4-J5-J7",
    K8: "=K4-K5-K7",
    L8: "=L4-L5-L7",

    B9: "=B8/B4",
    C9: "=C8/C4",
    D9: "=D8/D4",
    E9: "=E8/E4",
    F9: "=F8/F4",
    G9: "=G8/G4",
    H9: "=H8/H4",
    I9: "=I8/I4",
    J9: "=J8/J4",
    K9: "=K8/K4",
    L9: "=L8/L4",

    C11: "=B3-0.01",
    D11: "=B3-0.02",
    E11: "=B3-0.03",
    F11: "=B3-0.04",
    G11: "=B3-0.05",
    H11: "=B3-0.06",
    I11: "=B3-0.07",
    J11: "=B3-0.08",
    K11: "=B3-0.09",
    L11: "=B3-0.10",

    B12: "=$B$4",
    C12: "=$B$4",
    D12: "=$B$4",
    E12: "=$B$4",
    F12: "=$B$4",
    G12: "=$B$4",
    H12: "=$B$4",
    I12: "=$B$4",
    J12: "=$B$4",
    K12: "=$B$4",
    L12: "=$B$4",

    C13: "=C12-C14",
    D13: "=D12-D14",
    E13: "=E12-E14",
    F13: "=F12-F14",
    G13: "=G12-G14",
    H13: "=H12-H14",
    I13: "=I12-I14",
    J13: "=J12-J14",
    K13: "=K12-K14",
    L13: "=L12-L14",

    C14: "=$B$4*C11",
    D14: "=$B$4*D11",
    E14: "=$B$4*E11",
    F14: "=$B$4*F11",
    G14: "=$B$4*G11",
    H14: "=$B$4*H11",
    I14: "=$B$4*I11",
    J14: "=$B$4*J11",
    K14: "=$B$4*K11",
    L14: "=$B$4*L11",

    B15: "=mq_future!H13*1000000",
    C15: "=B15",
    D15: "=B15",
    E15: "=B15",
    F15: "=B15",
    G15: "=B15",
    H15: "=B15",
    I15: "=B15",
    J15: "=B15",
    K15: "=B15",
    L15: "=B15",

    C16: "=C12-C13-C15",
    D16: "=D12-D13-D15",
    E16: "=E12-E13-E15",
    F16: "=F12-F13-F15",
    G16: "=G12-G13-G15",
    H16: "=H12-H13-H15",
    I16: "=I12-I13-I15",
    J16: "=J12-J13-J15",
    K16: "=K12-K13-K15",
    L16: "=L12-L13-L15",

    B17: "=B8/B4",
    C17: "=C16/C12",
    D17: "=D16/D12",
    E17: "=E16/E12",
    F17: "=F16/F12",
    G17: "=G16/G12",
    H17: "=H16/H12",
    I17: "=I16/I12",
    J17: "=J16/J12",
    K17: "=K16/K12",
    L17: "=L16/L12"
  },
};

export const seedAllSheets = async () => {
  // Build all sheet data
  const allData: DataType[] = Object.entries(sheetsData).flatMap(
    ([sheetName, data]) => buildSheetData(sheetName, data)
  );

  // Use bulkWrite for efficient upsert operations
  const bulkOps = allData.map((item) => ({
    updateOne: {
      filter: { user: item.user, sheet: item.sheet, cell: item.cell },
      update: { $set: item },
      upsert: true,
    },
  }));

  await Data.bulkWrite(bulkOps);
};
