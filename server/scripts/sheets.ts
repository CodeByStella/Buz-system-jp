//スタート Start
//MQ（現状） MQCurrentStatus
//①利益 Profit
//②⑧MQ（未来） MQFuture
//③給料 Salary
//④経費 Expenses
//⑤製造原価(人) ManufacturingCostPerson
//⑥製造（経費) ManufacturingExpenses
//⑦原価詳細 CostDetail
//損益分岐点 BreakEvenPoint
//進捗実績値入力シート ProgressResultInput
//部門別販売計画 SalesPlanByDepartment
//利益計画表 ProfitPlaningTable

import { Data, DataType } from "@/models/data";

// Helper function to build sheet data
const buildSheetData = (
  sheetName: string,
  data: { [cell: string]: string | number }
): DataType[] => {
  return Object.entries(data).map(
    ([cell, val]): DataType => ({
      user: "",
      sheet: sheetName,
      cell,
      value: typeof val === "number" ? val : 0,
      formula: typeof val === "string" ? val : "",
    })
  );
};

// Sheet data definitions
const sheetsData: Record<string, { [cell: string]: string | number }> = {
  start: {
    C7: "=C6-G102",
    C8: '=IFERROR(C7/C6,"")',
    C102: "=SUM(G64:G67)",
    C103: "=SUM(G69:G72)",
    C104: "=G105+C102-C103",
    C105: "=SUM(G74:G77)",
    C106: "=SUM(G79:G82)",
    D57: "=SUM(D60:D62)",
    G102: "=SUM(D12:D58)+SUM(D63:D100)",
    G103: "=SUM(C12:C100)",
    G105: "=C7-G103",
    G106: "=C104+C105-C106",
  },
  mq_current_status: {
    B3: "=start!C6",
    B13: "=L3*Q3",
    F3: "=start!G102",
    F13: "=start!C7",
    H13: "=start!G103",
    H18: "=start!G105+start!C102-start!C103+start!C105-start!C106",
  },
  profit: {
    B6: "=B3+B4-B5",
    I5: "=B6+13-14",
    I7: "=15/start!G106",
  },
  mq_future: {
    B3: "=manufacturing_income! F31/1000000",
    F3: "=manufacturing_expenses!12",
    F13: "=B3-F3",
    F17: "=manufacturing_income!B36/1000000-F13",
    G16: "=F13/B3",
    H13: "=expenses!12*1000000/1000000",
    H18: "=F13-H13",
    I10: "=F3/B3",
    I16: "=H13/B3",
    I21: "=H18/B3",
    I22: "=profit!15",
    L3: "=manufacturing_income!E31",
    L13: 0,
    Q3: "=manufacturing_income!D31",
    Q13: 0,
  },
  salary: {
    E6: "=C6*D6",
    E7: "=C7*D7",
    E8: "=C8*D8",
    E9: "=C9*D9",
    E10: "=C10*D10",
    E11: "=C11*D11",
    E12: "=C12*D12",
    E13: "=C13*D13",
    E14: "=SUM(E6:E13)",
    E15: "=start!C12",
    D14: "=SUM(D6:D13)",

    J6: "=H6*I6",
    J7: "=H7*I7",
    J8: "=H8*I8",
    J9: "=H9*I9",
    J10: "=H10*I10",
    J11: "=H11*I11",
    J12: "=H12*I12",
    J13: "=H13*I13",
    J14: "=SUM(J6:J13)",
    J15: "=start!C16",
    I14: "=SUM(I6:I13)",

    O6: "=M6*N6",
    O7: "=M7*N7",
    O8: "=M8*N8",
    O9: "=M9*N9",
    O10: "=M10*N10",
    O11: "=M11*N11",
    O12: "=M12*N12",
    O13: "=M13*N13",
    O14: "=SUM(O6:O13)",
    O15: "=start!C17+start!C18",
    N14: "=SUM(N6:N13)",

    C18: "=(E14+J14+014)/(D14+114+N14)",
    C19: '=IFERROR((E15+J15+015)/(N15+115+D15),"0")',

    E18: "=C18/C19",
  },
  expenses: {
    C43: "=SUM(C5:C42)",
    C44: "=SUM(start!C63:C100)",

    F13: "=SUM(F4:F12)",
    F14: "=SUM(start!C37:C42)",

    I5: "=salary!E14",
    I6: "=salary!J14",
    I7: "=salary!O14",
    I24: "=SUM(I5:I23)",
    I25: "=SUM(start!C12:C28)",
    L16: "=SUM(L5:L15)",
    L17: "=SUM(start!C29:C34)",

    I2: "=L16+124+F13+C43",
  },
  manufacturing_labor: {
    E6: "=C6*D6",
    E7: "=C7*D7",
    E8: "=C8*D8",
    E9: "=C9*D9",
    E10: "=C10*D10",
    E11: "=C11*D11",
    E12: "=C12*D12",
    E13: "=C13*D13",
    E14: "=SUM(E6:E13)",
    E15: "=start!D60",
    D14: "=SUM(D6:D13)",

    J6: "=H6*I6",
    J7: "=H7*I7",
    J8: "=H8*I8",
    J9: "=H9*I9",
    J10: "=H10*I10",
    J11: "=H11*I11",
    J12: "=H12*I12",
    J13: "=H13*I13",
    J14: "=SUM(J6:J13)",
    J15: "=start!D61",
    I14: "=SUM(I6:I13)",

    O6: "=M6*N6",
    O7: "=M7*N7",
    O8: "=M8*N8",
    O9: "=M9*N9",
    O10: "=M10*N10",
    O11: "=M11*N11",
    O12: "=M12*N12",
    O13: "=M13*N13",
    O14: "=SUM(O6:O13)",
    O15: "=start!D62",
    N14: "=SUM(N6:N13)",

    C18: "=(E14+J14+014)/(D14+114+N14)",
    C19: '=IFERROR((E15+J15+015)/(N15+115+D15),"0")',

    E18: "=C18/C19",
  },
  manufacturing_expenses: { 
    C43: "",
    C44: "",

    F13: "",
    F14: "",

    I5: "",
    I6: "",
    I7: "",
    I16: "",
    I17: "",

    L20: "",
    L21: "",

    I2: "",
  },
  manufacturing_income: { 
    G2: "",

    B8: "",
    B9: "",
    B10: "",
    B11: "",
    B12: "",
    B13: "",
    B14: "",
    B15: "",
    B16: "",
    B17: "",
    B18: "",
    B19: "",
    B20: "",
    B21: "",
    B22: "",
    B23: "",
    B24: "",
    B25: "",
    B26: "",
    B27: "",
    B28: "",
    B29: "",

    D8: "",
    D9: "",
    D10: "",
    D11: "",
    D12: "",
    D13: "",
    D14: "",
    D15: "",
    D16: "",
    D17: "",
    D18: "",
    D19: "",
    D20: "",
    D21: "",
    D22: "",
    D23: "",
    D24: "",
    D25: "",
    D26: "",
    D27: "",
    D28: "",
    D29: "",

    G8: "",
    G9: "",
    G10: "",
    G11: "",
    G12: "",
    G13: "",
    G14: "",
    G15: "",
    G16: "",
    G17: "",
    G18: "",
    G19: "",
    G20: "",
    G21: "",
    G22: "",
    G23: "",
    G24: "",
    G25: "",
    G26: "",
    G27: "",
    G28: "",
    G29: "",

    B31: "",
    C31: "",
    D31: "",
    E31: "",
    F31: "",
    G31: "",

    G33: "",

    B34: "",
    C34: "",

    B36: "",
    F36: "",
    G36: "",
  },
  break_even_point: { 
    B2: "",
    B3: "",
    B4: "",
    B5: "",
    B6: "",

    E2: "",
    E3: "",
    E4: "",
    E5: "",
    E6: "",
  },
  progress_result_input: { 
    B2: "",
    L2: "",

    C3: "",

    C5: "",
    C6: "",
    C7: "",
    C8: "",
    C9: "",
    C10: "",
    C11: "",
    C12: "",
    C13: "",
    C14: "",
    C15: "",
    C16: "",
    C17: "",
    C18: "",
    C19: "",
    C20: "",
    D20: "",

    C22: "",
    C23: "",
    C24: "",
    C25: "",
    C26: "",
    C27: "",
    C28: "",
    C29: "",
    C30: "",
    C31: "",
    C32: "",
    C33: "",
    C34: "",
    C35: "",
    C36: "",
    C37: "",
    C38: "",
    C39: "",
    C40: "",
    C41: "",
    C42: "",
    C43: "",
    C44: "",
    C45: "",
    C46: "",
    C47: "",
    C48: "",
    C49: "",
    C50: "",
    C51: "",
    C52: "",
    C53: "",
    C54: "",
    C55: "",
    C56: "",
    C57: "",
    C58: "",
    C59: "",
    C60: "",
    C61: "",
    D61: "",

    G6: "",
    G7: "",
    G8: "",
    G9: "",
    G10: "",
    G11: "",
    G12: "",
    G13: "",
    G14: "",
    G15: "",
    G16: "",
    G17: "",
    H17: "",

    G20: "",
    G21: "",
    G22: "",
    G23: "",
    G24: "",
    G25: "",
    G26: "",
    G27: "",
    G28: "",
    G29: "",
    G30: "",
    G31: "",
    G32: "",
    G33: "",
    G34: "",
    G35: "",
    G36: "",
    G37: "",
    G38: "",
    G39: "",
    H39: "",

    G41: "",
    G42: "",
    G43: "",
    G44: "",
    G45: "",
    G46: "",
    G47: "",
    G48: "",
    G49: "",
    G50: "",
    H50: "",

    L6: "",
    L7: "",
    L8: "",
    L9: "",
    L10: "",
    L11: "",
    L12: "",
    L13: "",
    L14: "",
    L15: "",
    L16: "",
    L17: "",
    L18: "",
    L19: "",
    L20: "",
    L21: "",
    M21: "",

    L24: "",
    L25: "",
    L26: "",
    L27: "",
    L28: "",
    L29: "",
    L30: "",
    L31: "",
    L32: "",
    L33: "",
    L34: "",
    L35: "",
    M35: "",

    L37: "",
    L38: "",
    L39: "",
    L40: "",
    L41: "",
    L42: "",
    L43: "",
    L44: "",
    L45: "",
    L46: "",
    M46: "",

    Q6: "",
    Q7: "",
    Q8: "",
    Q9: "",
    Q10: "",
    Q11: "",
    Q12: "",
    Q13: "",
    Q14: "",
    Q15: "",
    Q16: "",
    Q17: "",
    Q18: "",
    Q19: "",
    Q20: "",
    Q21: "",
    Q22: "",
    Q23: "",
    Q24: "",
    Q25: "",
    Q26: "",
    Q27: "",
    Q28: "",
    Q29: "",
    Q30: "",
    Q31: "",
    Q32: "",
    Q33: "",
    Q34: "",
    Q35: "",
    Q36: "",
    Q37: "",
    Q38: "",
    Q39: "",
    Q40: "",
    Q41: "",
    Q42: "",
    Q43: "",
    Q44: "",
    R44: "",
  },
  sales_plan_by_department: { 
    B2: "",
    B3: "",
    B4: "",
    B5: "",
    B6: "",
    B7: "",
    B8: "",
    B9: "",
    B10: "",
    B11: "",
    B12: "",
    B13: "",
    B14: "",
    B15: "",
    B16: "",
    B17: "",
    B18: "",
    B19: "",
    B20: "",
    B21: "",
    B22: "",
    B23: "",
    B24: "",
    B25: "",
    B26: "",
    B27: "",
    B28: "",
    B29: "",
    B30: "",
    B31: "",
    B32: "",
    B33: "",
    B34: "",
    B35: "",
    B36: "",
    B37: "",
    B38: "",
    B39: "",
    B40: "",
    B41: "",
    B42: "",
    B43: "",
    B44: "",
    B45: "",
    B46: "",

    D3: "",
    D4: "",
    D5: "",
    D6: "",
    D7: "",
    D8: "",
    D9: "",
    D10: "",
    D11: "",
    D12: "",
    D13: "",
    D14: "",
    D15: "",
    D16: "",
    D17: "",
    D18: "",
    D19: "",
    D20: "",
    D21: "",
    D22: "",
    D23: "",
    D24: "",
    D25: "",
    D26: "",
    D27: "",
    D28: "",
    D29: "",
    D30: "",
    D31: "",
    D32: "",
    D33: "",
    D34: "",
    D35: "",
    D36: "",
    D37: "",
    D38: "",
    D39: "",
    D40: "",
    D41: "",
    D42: "",
    D43: "",
    D44: "",
    D45: "",
    D46: "",

    G3: "",
    G4: "",
    G5: "",
    G6: "",
    G7: "",
    G8: "",
    G9: "",
    G10: "",
    G11: "",
    G12: "",
    G13: "",
    G14: "",
    G15: "",
    G16: "",
    G17: "",
    G18: "",
    G19: "",
    G20: "",
    G21: "",
    G22: "",
    G23: "",
    G24: "",
    G25: "",
    G26: "",
    G27: "",
    G28: "",
    G29: "",
    G30: "",
    G31: "",
    G32: "",
    G33: "",
    G34: "",
    G35: "",
    G36: "",
    G37: "",
    G38: "",
    G39: "",
    G40: "",
    G41: "",
    G42: "",
    G43: "",
    G44: "",
    G45: "",
    G46: "",

    I3: "",
    I4: "",
    I5: "",
    I6: "",
    I7: "",
    I8: "",
    I9: "",
    I10: "",
    I11: "",
    I12: "",
    I13: "",
    I14: "",
    I15: "",
    I16: "",
    I17: "",
    I18: "",
    I19: "",
    I20: "",
    I21: "",
    I22: "",
    I23: "",
    I24: "",
    I25: "",
    I26: "",
    I27: "",
    I28: "",
    I29: "",
    I30: "",
    I31: "",
    I32: "",
    I33: "",
    I34: "",
    I35: "",
    I36: "",
    I37: "",
    I38: "",
    I39: "",
    I40: "",
    I41: "",
    I42: "",
    I43: "",
    I44: "",
    I45: "",
    I46: "",

    K3: "",
    K4: "",
    K5: "",
    K6: "",
    K7: "",
    K8: "",
    K9: "",
    K10: "",
    K11: "",
    K12: "",
    K13: "",
    K14: "",
    K15: "",
    K16: "",
    K17: "",
    K18: "",
    K19: "",
    K20: "",
    K21: "",
    K22: "",
    K23: "",
    K24: "",
    K25: "",
    K26: "",
    K27: "",
    K28: "",
    K29: "",
    K30: "",
    K31: "",
    K32: "",
    K33: "",
    K34: "",
    K35: "",
    K36: "",
    K37: "",
    K38: "",
    K39: "",
    K40: "",
    K41: "",
    K42: "",
    K43: "",
    K44: "",
    K45: "",
    K46: "",

    M3: "",
    M4: "",
    M5: "",
    M6: "",
    M7: "",
    M8: "",
    M9: "",
    M10: "",
    M11: "",
    M12: "",
    M13: "",
    M14: "",
    M15: "",
    M16: "",
    M17: "",
    M18: "",
    M19: "",
    M20: "",
    M21: "",
    M22: "",
    M23: "",
    M24: "",
    M25: "",
    M26: "",
    M27: "",
    M28: "",
    M29: "",
    M30: "",
    M31: "",
    M32: "",
    M33: "",
    M34: "",
    M35: "",
    M36: "",
    M37: "",
    M38: "",
    M39: "",
    M40: "",
    M41: "",
    M42: "",
    M43: "",
    M44: "",
    M45: "",
    M46: "",

    O3: "",
    O4: "",
    O5: "",
    O6: "",
    O7: "",
    O8: "",
    O9: "",
    O10: "",
    O11: "",
    O12: "",
    O13: "",
    O14: "",
    O15: "",
    O16: "",
    O17: "",
    O18: "",
    O19: "",
    O20: "",
    O21: "",
    O22: "",
    O23: "",
    O24: "",
    O25: "",
    O26: "",
    O27: "",
    O28: "",
    O29: "",
    O30: "",
    O31: "",
    O32: "",
    O33: "",
    O34: "",
    O35: "",
    O36: "",
    O37: "",
    O38: "",
    O39: "",
    O40: "",
    O41: "",
    O42: "",
    O43: "",
    O44: "",
    O45: "",
    O46: "",

    Q3: "",
    Q4: "",
    Q5: "",
    Q6: "",
    Q7: "",
    Q8: "",
    Q9: "",
    Q10: "",
    Q11: "",
    Q12: "",
    Q13: "",
    Q14: "",
    Q15: "",
    Q16: "",
    Q17: "",
    Q18: "",
    Q19: "",
    Q20: "",
    Q21: "",
    Q22: "",
    Q23: "",
    Q24: "",
    Q25: "",
    Q26: "",
    Q27: "",
    Q28: "",
    Q29: "",
    Q30: "",
    Q31: "",
    Q32: "",
    Q33: "",
    Q34: "",
    Q35: "",
    Q36: "",
    Q37: "",
    Q38: "",
    Q39: "",
    Q40: "",
    Q41: "",
    Q42: "",
    Q43: "",
    Q44: "",
    Q45: "",
    Q46: "",

    S3: "",
    S4: "",
    S5: "",
    S6: "",
    S7: "",
    S8: "",
    S9: "",
    S10: "",
    S11: "",
    S12: "",
    S13: "",
    S14: "",
    S15: "",
    S16: "",
    S17: "",
    S18: "",
    S19: "",
    S20: "",
    S21: "",
    S22: "",
    S23: "",
    S24: "",
    S25: "",
    S26: "",
    S27: "",
    S28: "",
    S29: "",
    S30: "",
    S31: "",
    S32: "",
    S33: "",
    S34: "",
    S35: "",
    S36: "",
    S37: "",
    S38: "",
    S39: "",
    S40: "",
    S41: "",
    S42: "",
    S43: "",
    S44: "",
    S45: "",
    S46: "",

    U3: "",
    U4: "",
    U5: "",
    U6: "",
    U7: "",
    U8: "",
    U9: "",
    U10: "",
    U11: "",
    U12: "",
    U13: "",
    U14: "",
    U15: "",
    U16: "",
    U17: "",
    U18: "",
    U19: "",
    U20: "",
    U21: "",
    U22: "",
    U23: "",
    U24: "",
    U25: "",
    U26: "",
    U27: "",
    U28: "",
    U29: "",
    U30: "",
    U31: "",
    U32: "",
    U33: "",
    U34: "",
    U35: "",
    U36: "",
    U37: "",
    U38: "",
    U39: "",
    U40: "",
    U41: "",
    U42: "",
    U43: "",
    U44: "",
    U45: "",
    U46: "",

    W3: "",
    W4: "",
    W5: "",
    W6: "",
    W7: "",
    W8: "",
    W9: "",
    W10: "",
    W11: "",
    W12: "",
    W13: "",
    W14: "",
    W15: "",
    W16: "",
    W17: "",
    W18: "",
    W19: "",
    W20: "",
    W21: "",
    W22: "",
    W23: "",
    W24: "",
    W25: "",
    W26: "",
    W27: "",
    W28: "",
    W29: "",
    W30: "",
    W31: "",
    W32: "",
    W33: "",
    W34: "",
    W35: "",
    W36: "",
    W37: "",
    W38: "",
    W39: "",
    W40: "",
    W41: "",
    W42: "",
    W43: "",
    W44: "",
    W45: "",
    W46: "",

    Y3: "",
    Y4: "",
    Y5: "",
    Y6: "",
    Y7: "",
    Y8: "",
    Y9: "",
    Y10: "",
    Y11: "",
    Y12: "",
    Y13: "",
    Y14: "",
    Y15: "",
    Y16: "",
    Y17: "",
    Y18: "",
    Y19: "",
    Y20: "",
    Y21: "",
    Y22: "",
    Y23: "",
    Y24: "",
    Y25: "",
    Y26: "",
    Y27: "",
    Y28: "",
    Y29: "",
    Y30: "",
    Y31: "",
    Y32: "",
    Y33: "",
    Y34: "",
    Y35: "",
    Y36: "",
    Y37: "",
    Y38: "",
    Y39: "",
    Y40: "",
    Y41: "",
    Y42: "",
    Y43: "",
    Y44: "",
    Y45: "",
    Y46: "",

    AA3: "",
    AA4: "",
    AA5: "",
    AA6: "",
    AA7: "",
    AA8: "",
    AA9: "",
    AA10: "",
    AA11: "",
    AA12: "",
    AA13: "",
    AA14: "",
    AA15: "",
    AA16: "",
    AA17: "",
    AA18: "",
    AA19: "",
    AA20: "",
    AA21: "",
    AA22: "",
    AA23: "",
    AA24: "",
    AA25: "",
    AA26: "",
    AA27: "",
    AA28: "",
    AA29: "",
    AA30: "",
    AA31: "",
    AA32: "",
    AA33: "",
    AA34: "",
    AA35: "",
    AA36: "",
    AA37: "",
    AA38: "",
    AA39: "",
    AA40: "",
    AA41: "",
    AA42: "",
    AA43: "",
    AA44: "",
    AA45: "",
    AA46: "",
  },
  profit_planing_table: { 
    B3: "",
    C3: "",
    D3: "",
    E3: "",
    F3: "",
    G3: "",
    H3: "",
    I3: "",
    J3: "",
    K3: "",
    L3: "",

    B4: "",
    C4: "",
    D4: "",
    E4: "",
    F4: "",
    G4: "",
    H4: "",
    I4: "",
    J4: "",
    K4: "",
    L4: "",

    B5: "",
    C5: "",
    D5: "",
    E5: "",
    F5: "",
    G5: "",
    H5: "",
    I5: "",
    J5: "",
    K5: "",
    L5: "",

    B6: "",
    C6: "",
    D6: "",
    E6: "",
    F6: "",
    G6: "",
    H6: "",
    I6: "",
    J6: "",
    K6: "",
    L6: "",

    B7: "",
    C7: "",
    D7: "",
    E7: "",
    F7: "",
    G7: "",
    H7: "",
    I7: "",
    J7: "",
    K7: "",
    L7: "",

    B8: "",
    C8: "",
    D8: "",
    E8: "",
    F8: "",
    G8: "",
    H8: "",
    I8: "",
    J8: "",
    K8: "",
    L8: "",

    B9: "",
    C9: "",
    D9: "",
    E9: "",
    F9: "",
    G9: "",
    H9: "",
    I9: "",
    J9: "",
    K9: "",
    L9: "",

    B11: "",
    C11: "",
    D11: "",
    E11: "",
    F11: "",
    G11: "",
    H11: "",
    I11: "",
    J11: "",
    K11: "",
    L11: "",

    B12: "",
    C12: "",
    D12: "",
    E12: "",
    F12: "",
    G12: "",
    H12: "",
    I12: "",
    J12: "",
    K12: "",
    L12: "",

    B13: "",
    C13: "",
    D13: "",
    E13: "",
    F13: "",
    G13: "",
    H13: "",
    I13: "",
    J13: "",
    K13: "",
    L13: "",

    B14: "",
    C14: "",
    D14: "",
    E14: "",
    F14: "",
    G14: "",
    H14: "",
    I14: "",
    J14: "",
    K14: "",
    L14: "",

    B15: "",
    C15: "",
    D15: "",
    E15: "",
    F15: "",
    G15: "",
    H15: "",
    I15: "",
    J15: "",
    K15: "",
    L15: "",

    B16: "",
    C16: "",
    D16: "",
    E16: "",
    F16: "",
    G16: "",
    H16: "",
    I16: "",
    J16: "",
    K16: "",
    L16: "",

    B17: "",
    C17: "",
    D17: "",
    E17: "",
    F17: "",
    G17: "",
    H17: "",
    I17: "",
    J17: "",
    K17: "",
    L17: "",
  },
};

export const seedAllSheets = async () => {
  // Build all sheet data
  const allData: DataType[] = Object.entries(sheetsData).flatMap(
    ([sheetName, data]) => buildSheetData(sheetName, data)
  );

  // Use bulkWrite for efficient upsert operations
  const bulkOps = allData.map((item) => ({
    updateOne: {
      filter: { user: item.user, sheet: item.sheet, cell: item.cell },
      update: { $set: item },
      upsert: true,
    },
  }));

  await Data.bulkWrite(bulkOps);
};
